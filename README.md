# win-ioc-detect
Powershell Log4j Exploit detection
https://gmuisg.org/log4j-detect/
## Table of contents
* [General info](#general-info)
* [Getting started](#getting-started)
* [Usage](#usage)

## General info
The script will quickly scan over Windows event viewer logs like new process creation, new scheduled tasks, and ADFS logs) and check for any indication of log4shell or indicators of exploitation attempts. The script will find obfuscated strings in Base64 and the known log4shell detection strings in the wild. Feel free to add custom IOC patterns as the obfuscation of the reverse shells get tougher and more obfuscated

TL;DR the script will search common event viewer logs for exploitation attempts.
	
## Getting started
To run this project, extract it to a local directory then open an Administrator powershell<br />
```
Install-Script Get-Base64RegularExpression.ps1 
set-executionpolicy remotesigned
```
Keep in mind the script nrequires certain security audit logging enabled to function!!<br />

<b>REQUIRES Audit Process Creation logging. Audit event 4688(S): "A new process has been created"<br />
REQUIRES Audit Other Object Access Events. Audit event 4698(S): "This policy setting allows you to audit events generated by the management of task scheduler"</b><br />

## Usage
Simply just run the script win-log4shell-detect.ps1

```
.\win-log4shell-detect
```

## Notes

Get-Base64RegularExpression https://www.leeholmes.com/searching-for-content-in-base-64-strings/

https://www.lansweeper.com/report/log4j-event-log-audit/

Got the idea from https://github.com/Neo23x0/log4shell-detector
