# win-ioc-detect
Powershell IOC Exploit detection
https://gmuisg.org/log4j-detect/
## Table of contents
* [General info](#general-info)
* [Getting started](#getting-started)
* [Usage](#usage)

## General info
The script will swiftly search Windows event viewer logs (such as new process creation, new scheduled tasks, and ADFS logs) for any signs of log4shell or exploitation attempts. The script will look for obfuscated Base64 strings as well as known log4shell detection strings in the wild.
Feel free to add custom IOC patterns as the reverse shells' obfuscation becomes tougher and more obfuscated. 

TL;DR the script will search common event viewer logs for exploitation attempts.
	
## Getting started
To run this project, extract it to a local directory then open an Administrator powershell<br />
```
Install-Script Get-Base64RegularExpression.ps1 
Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Unrestricted
```
Keep in mind the script requires certain security audit logging enabled to function!!<br />

<b>REQUIRES Audit Process Creation logging. Audit event 4688(S): "A new process has been created"<br />
REQUIRES PowerShell Script Block Logging Audit event 4104(S): "Verbose; Microsoft-Windows-PowerShell/Operational"<br />
REQUIRES Audit Other Object Access Events. Audit event 4698(S): "This policy setting allows you to audit events generated by the management of task scheduler"</b><br />

## Usage
Simply just run the script win-ioc-detect.ps1

```
.\win-ioc-detect
```

## Notes

Get-Base64RegularExpression https://www.leeholmes.com/searching-for-content-in-base-64-strings/

https://www.lansweeper.com/report/log4j-event-log-audit/

Got the idea from https://github.com/Neo23x0/log4shell-detector
