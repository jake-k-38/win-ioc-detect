# win-ioc-detect
Powershell IOC Exploit detection
https://gmuisg.org/log4j-detect/
## Table of contents
* [General info](#general-info)
* [Getting started](#getting-started)
* [Usage](#usage)

## General info
The script will swiftly inspect Windows event viewer logs for any indicators of exploitation attempts (such as new process creation, new scheduled tasks, WinAV, Audit policy, and WinPS). The script will look for obfuscated Base64 common APT execution patterns in the wild. 

TL;DR the script will search common event viewer logs for exploitation attempts on machine.

![snip1](https://github.com/jake-k-38/win-ioc-detect/blob/main/images/screenshot_1.png?raw=true)
	
## Getting started
To run this project, extract it to a local directory then open an Administrator powershell<br />
```
Install-Script Get-Base64RegularExpression.ps1 
Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Unrestricted
```
Keep in mind the script requires certain security audit logging enabled to function!!<br />

<b>REQUIRES Audit Process Creation logging. Audit event 4688(S): "A new process has been created"<br />
REQUIRES PowerShell Script Block Logging Audit event 4104(S): "Verbose; Microsoft-Windows-PowerShell/Operational"<br />
REQUIRES Audit Other Object Access Events. Audit event 4698(S): "This policy setting allows you to audit events generated by the management of task scheduler"</b><br />

## Usage
Simply just run the script win-ioc-detect.ps1

```
.\win-ioc-detect
```

## Notes

Get-Base64RegularExpression https://www.leeholmes.com/searching-for-content-in-base-64-strings/

https://www.lansweeper.com/report/log4j-event-log-audit/

Got the idea from https://github.com/Neo23x0/log4shell-detector

To-do accept .evtx input for offline forensic scanning
